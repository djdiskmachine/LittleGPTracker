FROM --platform=linux/amd64 ubuntu:22.04

# Install build dependencies
RUN apt-get update && apt-get install -y \
    build-essential \
    make \
    wget \
    xz-utils \
    python3 \
    python3-pillow \
    && rm -rf /var/lib/apt/lists/*

# Download and install RG35XX Plus toolchain
RUN wget -O /tmp/rg35xx-plus-aarch64-SDL2-SDK-0.1.0.tar.xz \
    https://github.com/simotek/rg35xx-plus-aarch64-SDL2-SDK/releases/download/0.1.0/rg35xx-plus-aarch64-SDL2-SDK-0.1.0.tar.xz && \
    mkdir -p /opt/rg35xx-plus-aarch64-SDL2-SDK-0.1.0 && \
    tar -xvf /tmp/rg35xx-plus-aarch64-SDL2-SDK-0.1.0.tar.xz -C /opt/rg35xx-plus-aarch64-SDL2-SDK-0.1.0 --strip-components=1 && \
    rm /tmp/rg35xx-plus-aarch64-SDL2-SDK-0.1.0.tar.xz

WORKDIR /workspace/projects

CMD ["make", "PLATFORM=RG35XXPLUS"]
